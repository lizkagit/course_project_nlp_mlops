FROM python:3.11-slim

WORKDIR /app

# –°–Ω–∞—á–∞–ª–∞ –∫–æ–ø–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ requirements.txt –¥–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è
COPY service/requirements.txt .

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä—É–µ–º –≤–µ—Å—å –∫–æ–¥
COPY service/api.py .
COPY service/predictor.py .
COPY service/models ./models/
COPY config_loader.py .

# –ö–æ–ø–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥–∏
COPY configs ./configs/

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–æ—Å—å
RUN echo "üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:" && \
    ls -la && \
    echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ configs:" && \
    ls -la configs/ && \
    echo "üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ models:" && \
    ls -la models/

EXPOSE 8000

CMD ["python", "api.py"]